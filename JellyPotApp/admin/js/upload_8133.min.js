var BetJs;$(document).ready(function(){BetJs.Jelly.Texts.Ini(adminLang)}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.Texts=function(){var i={Ini:function(e){var t,a="cs"===e?l:n;for(t in a)i[t]=a[t]}},l={treeNoSelection:"Žádný řádek není označen.",treeNoLeft:"Řádek nelze posunout doleva.",treeNoRight:"Řádek nelze posunout doprava.",btRowEdit:"edit",imgBtEdit:"edit",imgColBtEdit:"edit",fileBtRowEdit:"edit"},n={treeNoSelection:"No row is selected.",treeNoLeft:"The row can not be moved left.",treeNoRight:"The row can not be moved right.",btRowEdit:"edit",imgBtEdit:"edit",imgColBtEdit:"edit",fileBtRowEdit:"edit"};return i}(),$(document).ready(function(){BetJs.Jelly.ImgCol.Ini(),BetJs.Jelly.Img.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.ImgCol=function(){var e={Ini:function(){t(),a(),$(".imgColContainer.sortable").imgColSortable()}},t=function(){var e=BetJs.Jelly.Texts.imgColBtEdit;$(".imgColItem .outer").append('<span class="edit jBtImgColEdit">'+e+"</span>")},a=function(){$(".jBtImgColEdit").on("click.imgCol",function(){i(this)}),$(".imgColItem").on("dblclick.imgCol",function(){i(this)})},i=function(e){var t,a,i=$(e).closest("div.imgColItem");i.attr("data-v")?(t=i.attr("data-v"),BetJs.Jelly.Admin.OpenVariable(t)):i.attr("data-colimg")&&(a=i.attr("data-colimg").split(","),e=$.trim(a[0]),t=$.trim(a[1]),i=Number($.trim(a[2])),a=Number($.trim(a[3])),BetJs.Jelly.Admin.ImgEdit(e,t,a,i))};return e}(),BetJs.Jelly.Img=function(){var e={Ini:function(){t(),a()}},t=function(){var e=BetJs.Jelly.Texts.imgBtEdit;$(".singleImgItem .outer").append('<span class="edit jBtImgEdit">'+e+"</span>")},a=function(){$(".jBtImgEdit").on("click.imgCol",function(){i(this)}),$(".singleImgItem").on("dblclick.imgCol",function(){i(this)})},i=function(e){var t,a,i,l,n,e=$(e).closest("div.singleImgItem");e.attr("data-img")?(t=e.attr("data-img").split(","),a=$.trim(t[0]),i=$.trim(t[1]),l=Number($.trim(t[2])),n=$.trim(t[3]),BetJs.Jelly.Admin.ImgEdit(a,i,l,n)):e.attr("data-simg")&&(t=e.attr("data-simg").split(","),a=$.trim(t[0]),i=$.trim(t[1]),l=Number($.trim(t[2])),n=$.trim(t[3]),BetJs.Jelly.Admin.SimpleImgEdit(a,i,l,n))};return e}(),function(s){s.fn.multiSortable=function(e){s(this).data("sortData",e),this.children().off("mousedown.multiSortable").on("mousedown.multiSortable",function(e){e.ctrlKey||e.metaKey?s(e.currentTarget).toggleClass("ui-selecting"):s(e.currentTarget).hasClass("ui-selecting")||(s(".ui-selecting").removeClass("ui-selecting"),s(this).addClass("ui-selecting"))}),this.sortable({helper:"clone",update:function(e,t){var a=t.item,i=0;t.item.parent().children().each(function(){this.id!==t.item.get(0).id?s(this).hasClass("ui-selecting")&&(i?(a.after(this),a=s(this)):a.before(this)):i=1});var l,n,o=s(this).data("sortData");o&&o.onsort&&(l=[],s(this).children().each(function(){n=this.id.split("-"),l[l.length]=n[1]}),o.onsort(e,n[0],l))}})},s.fn.multiSortableDisable=function(){this.children().off("mousedown.multiSortable"),this.sortable("destroy")}}(jQuery),function(t){t.fn.imgColSortable=function(){var e="true"===t(this).children().attr("data-autosubmit");this.multiSortable({autosubmit:e,onsort:function(e,t,a){document.forms[0][t+"-Action"].value=3,document.forms[0][t+"-Params"].value=a.join(","),this.autosubmit&&document.forms[0].submit()}})}}(jQuery),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.UploadUtils=function(){var e={FileSizeAsText:function(e){return e<1022976?Math.floor(Math.max(e/1024,1))+" kB":(e=(e=Math.floor(e/1024/1024*10).toString()).substr(0,e.length-1)+"."+e.substring(e.length-1,e.length))+" MB"},DenyDialog:function(){parent&&(parent.BetJs.Jelly.Admin.DialogClose(window.name),parent.BetJs.Jelly.Admin.OpenAdmin("login.aspx?a=deny"))}};return e}(),$(document).ready(function(){BetJs.Jelly.FileUpload.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.FileUpload=function(){function e(){}var a,t,i={Ini:function(){var e=$(".jFileUploadForm");0!==e.length&&(e.fileupload({url:"fileLoad.ajax.aspx",maxChunkSize:9e5,add:l,fail:o,progressall:d,done:u}),fileId&&$(".jBtnUpload").attr("value",0===fileId?labelUpload:labelSave))}},o=function(e,t){if(t.jqXHR&&"FileTooLong"===t.jqXHR.responseText)$("#jUploadStatus").html(msgFileTooLong).addClass("resultErr"),g();else{var a=120,i=1e3,l=function(){$.ajax({url:"fileLoad.ajax.aspx",data:{action:"sizeQuery",uploadId:t.formData.uploadId,fileIdx:t.formData.fileIdx},dataType:"text",success:function(e){t.uploadedBytes=Number(e),t.data=null,t.submit()},error:function(e){403===e.status?s():o(e,t)}})},n=t.retries||0;if(n<a)return t.retries=n+=1,void window.setTimeout(l,i);p("BetJs: Unspecified error during upload - 701")}},l=function(e,t){0<t.files.length&&(1<t.files.length?p("BetJs: Wrong implementation - 702"):($(".jBtnUpload").attr("value",labelUpload).removeAttr("disabled").removeClass("disabled"),$("#jUploadStatus").html("&nbsp;").removeClass("resultErr"),n(t),a=t,0<maxFileLength&&t.files[0].size>1024*maxFileLength&&(p(msgFileTooLong),$(".jBtnUpload").attr("disabled","disabled").addClass("disabled"))))},n=function(e){var t=e.files[0],e=BetJs.Jelly.UploadUtils.FileSizeAsText(t.size),e="<strong>"+t.name+"</strong><span>"+e+"</span>";$("#lbInfo").html(e),$.ajax({url:"loadUtils.ajax.aspx",data:{action:"fileIcon",fileName:t.name},dataType:"text",success:function(e){$("#filePreview").html(e)}})};i.UploadStart=function(){if(!a)return 0<fileId?void f():(parent&&parent.BetJs.Jelly.Admin.SetFile(fieldName,0,fileIdx),void i.Close());c(),$.ajax({url:"fileLoad.ajax.aspx",data:{action:"startUpload",typePath:typePath,fieldName:fieldName,varType:varType},dataType:"text",success:function(e){t=e,r()},error:function(e){403===e.status?s():p("BetJs: Unspecified error on upload start - 703")}})},i.RemoveFile=function(){confirm(msgDeleteConfirm)&&($("#lbInfo").html("&nbsp;"),$("#filePreview").html(msgNoFile),fileId=0,a=void 0,$(".jBtnUpload").attr("value",labelSave))},i.Close=function(){parent&&parent.BetJs.Jelly.Admin.DialogClose(window.name)};var s=function(){BetJs.Jelly.UploadUtils.DenyDialog()},r=function(){var e;a&&(e=(e=a.files[0].fileName)||a.files[0].name,a.formData={fileIdx:0,uploadId:t,fileName:e},a.submit())},d=function(e,t){var a=Math.round(t.loaded/t.total*100),a=msgTrasferingData+" "+BetJs.Jelly.UploadUtils.FileSizeAsText(t.loaded)+" ("+a+" %)";$("#jUploadStatus").html(a).removeClass("resultErr")},u=function(e,t){Number(t.files[0].size)!==Number(t.result)?p("BetJs: Unspecified error during upload - 704"):m()},m=function(){var e="";document.forms[0].txAlt&&(e=document.forms[0].txAlt.value),$("#jUploadStatus").html(msgServerSaving).removeClass("resultErr"),$.ajax({url:"fileLoad.ajax.aspx",data:{action:"finishUpload",uploadId:t,alt:e},dataType:"text",success:function(e){parent&&(parent.BetJs.Jelly.Admin.SetFile(fieldName,e,fileIdx),i.Close())},error:function(e){if(403===e.status)s();else if(409===e.status){var t;try{t=JSON.parse(e.responseText)}catch(e){}p(t?t.errMsg:"BetJs: Unspecified error on upload finish - 705")}else p("BetJs: Unspecified error on upload finish - 706")}})},f=function(){document.forms[0].txAlt?$.ajax({url:"fileLoad.ajax.aspx",data:{action:"altEdit",typePath:typePath,fieldName:fieldName,fileId:fileId,alt:document.forms[0].txAlt.value},dataType:"text",success:function(){parent.BetJs.Jelly.Admin.Refresh(),i.Close()},error:function(e){403===e.status?s():p("BetJs: Unspecified error when saving data - 708")}}):i.Close()},p=function(e){$("#jUploadStatus").html(e).addClass("resultErr"),g()},c=function(){$(".jHidding").addClass("hidden"),$("#btSave").attr("disabled","disabled"),$(".jFileUploadForm").fileupload("option","add",e),$("#jButtons").hide()},g=function(){$(".jHidding").removeClass("hidden"),$("#btSave").removeAttr("disabled"),$(".jFileUploadForm").fileupload("option","add",l),$("#jButtons").show()};return i}(),$(document).ready(function(){BetJs.Jelly.ImgColUpload.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.ImgColUpload=function(){var d,a,i,l={},u=[],n=-1,o=0,s=0,t=0,m=-1,f=0;l.Ini=function(){var e=$(".jImgColUploadForm");0!==e.length&&e.fileupload({datatype:"json",url:"imgColLoad.ajax.aspx",autoupload:!1,maxChunkSize:9e5,add:r,fail:I,progressall:B,chunkdone:y,done:b})};function e(){}var r=function(e,t){var a;0<t.files.length&&(1<t.files.length?alert("BetJs: Wrong implementation - 702"):(t.isDeleted=!1,t.hasThumbnail=!1,t.isErr=!1,a=u.length,u[a]=t,p(a,t),$("#jBrowse").hide(),i||window.setInterval(c,200)))},p=function(e,t){var a="",i=t.files[0].fileName;a+='<div class="imgColItem" id="imgColItem-'+e+'">',a+='<div class="thumb"><div class="outer"><div class="inner loading"><p>creating thumb&hellip;</p></div></div></div>',a+='<p title="'+(i=i||t.files[0].name)+'">'+i+" "+BetJs.Jelly.UploadUtils.FileSizeAsText(t.files[0].size)+"</p>",a+="</div>",$(".jIconAreaContent").append(a),F()},c=function(){if(-1===n){for(var e=0;e<u.length;++e)if(!u[e].isRendered){n=e,window.loadImage(u[e].files[0],g,{maxWidth:138,maxHeight:138}),u[e].files[0].size;break}-1===n&&i&&(window.clearInterval(i),i=void 0)}},g=function(e){var t;-1!==n&&(t=$("#imgColItem-"+n+" .inner"),"error"===e.type?(t.removeClass("loading").html("<p class='iconText'>"+msgErrCreateThumb+"</p>"),0):t.removeClass("loading").html(e),u[n].isRendered=!0,n=-1)};l.UploadStart=function(){v()?(N(),$("#jUploadStatus").html(msgStartingTransfer).removeClass("resultErr"),$.ajax({url:"imgColLoad.ajax.aspx",data:{action:"startUpload",typePath:typePath,fieldName:fieldName},dataType:"text",success:function(e){d=e,J()},error:function(e){403===e.status?x():alert("BetJs: Unspecified error on upload start - 703")}})):l.Close()};var h,v=function(){for(var e=0;e<u.length;++e)if(!u[e].isDeleted)return!0;return!1},x=function(){BetJs.Jelly.UploadUtils.DenyDialog()},J=function(){for(var e,t=[],a=!1,i=s=o=0;i<u.length;++i)u[i].isDeleted||(o+=u[i].files[0].size,e=(e=u[i].files[0].fileName)||u[i].files[0].name,u[i].formData={fileIdx:i,uploadId:d,fileName:e},(a=a||5<=f)||(u[i].submit(),m=i,++f),t[t.length]=u[i].files[0].size);var l=msgTrasferingData+" 0 kB (0 %)";$("#jUploadStatus").html(l).removeClass("resultErr")},B=function(e,t){t=t.loaded;a=a||t;t=Math.max(t-a,0);j(s+t)},y=function(e,t){s+=t.chunkSize,a=void 0,j(s)},j=function(e){t=Math.max(t,e);e=Math.min(Math.round(t/o*100),100),e=msgTrasferingData+" "+BetJs.Jelly.UploadUtils.FileSizeAsText(t)+" ("+e+" %)";$("#jUploadStatus").html(e).removeClass("resultErr")},I=function(e,t){if(t.jqXHR&&"FileTooLong"===t.jqXHR.responseText)$("#jUploadStatus").html(msgFileTooLong).addClass("resultErr"),A();else{var a=t.retries||0;if(a<120)return t.retries=a+=1,void window.setTimeout(function(){U(e,t)},500);alert("BetJs: Unspecified error on upload - 701"),t.jqXHR&&$("#jUploadStatus").html(t.jqXHR.responseText).addClass("resultErr")}},U=function(e,t){$.ajax({url:"imgColLoad.ajax.aspx",data:{action:"getFileSize",uploadId:t.formData.uploadId,fileIdx:t.formData.fileIdx},dataType:"text",success:function(e){t.uploadedBytes=Number(e),t.data=null,t.submit()},error:function(e){403===e.status?x():I(e,t)}})},b=function(e,t){var a=t.formData.fileIdx;u[a].isUploaded=!0,Number(t.files[0].size)!==Number(t.result)&&(u[a].isErr=!0),$.ajax({url:"imgColLoad.ajax.aspx",data:{action:"finishFile",uploadId:d,fileIdx:a}});var i=!1;f-=1;for(var l=m+1;l<u.length;++l)u[l].isDeleted||(i=i||5<=f)||(u[l].submit(),m=l,++f);var n=!0;for(r=0;r<u.length;++r)u[r].isDeleted||u[r].isUploaded||(n=!1);if(n){for(var o=[],a=d,s=E(),r=0;r<s.length;++r)u[s[r]].isDeleted||u[s[r]].isErr||o.push(s[r]),!u[s[r]].isDeleted&&u[s[r]].isErr&&(n=!1);C(a,n,o)}},C=function(t,a,i){$("#jUploadStatus").html(msgServerSaving).removeClass("resultErr"),$.ajax({url:"imgColLoad.ajax.aspx",data:{action:"finishUpload",uploadId:t,typePath:typePath,fieldName:fieldName,idxs:i.join(",")},dataType:"text",success:function(e){"savingInProgres"===e?window.setTimeout(function(){C(t,a,i)},1e3):(S(a,destFieldName,e),a||w(i))},error:function(e){403===e.status?x():alert("BetJs: Unspecified error on upload finish - 704")}})},S=function(e,t,a){parent&&parent.BetJs.Jelly.Admin.SetImgBulk&&(parent.BetJs.Jelly.Admin.SetImgBulk(t,a),e&&l.Close(),e||($("#jUploadStatus").html(msgTryAgain).addClass("resultErr"),d=void 0,h=0,setTimeout(T,200)))},T=function(){++h,parent&&parent.SetImg?A():h<30&&setTimeout(T,200)},w=function(e){for(var t=0;t<e.length;++t){var a=e[t];u[a].isDeleted=!0,$("#imgColItem-"+a).remove()}for(t=0;t<u.length;++t)u[t].isErr=!1,u[t].isUploaded=!1},N=function(){$(".jHidding").addClass("hidden"),$("#btSave").attr("disabled","disabled"),$(".jImgColUploadForm").fileupload("option","add",e),$(".jIconAreaContent").multiSortableDisable(),$("#jButtons").hide()},A=function(){$(".jHidding").removeClass("hidden"),$("#btSave").removeAttr("disabled"),$(".jImgColUploadForm").fileupload("option","add",r),$("#jButtons").show(),F()};l.Close=function(){parent&&parent.BetJs.Jelly.Admin.DialogClose(window.name)},l.ClearSelected=function(){if(confirm(msgDeleteConfirm)){for(var e=D(),t=0;t<e.length;++t){var a=e[t];u[a].isDeleted=!0,$("#imgColItem-"+a).remove()}0===E().length&&$("#jBrowse").show()}},l.ClearAll=function(){confirm(msgDeleteConfirm)&&(u.length=0,$(".jIconAreaContent").empty(),$("#jBrowse").show())};var D=function(){var e,t=[];return $(".jIconAreaContent .ui-selecting").each(function(){e=this.id.split("-"),t[t.length]=e[1]}),t},F=function(){var e=$(".jIconAreaContent");e.data("ui-sortable")&&e.multiSortableDisable(),e.multiSortable()},E=function(){var e,t=[];return $(".jIconAreaContent").children().each(function(){e=this.id.split("-"),t[t.length]=e[1]}),t};return l}(),$(document).ready(function(){BetJs.Jelly.ImgUpload.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.ImgUpload=function(){var i,t,a={},l=0,n=0;a.Ini=function(){var e=$(".jImgUploadForm");0!==e.length&&(e.fileupload({url:"imgLoad.ajax.aspx",maxChunkSize:9e5,add:s,fail:o,progressall:p,done:c}),$(".jBtnUpload").attr("value",0===imgId?labelUpload:labelSave))};function e(){}var o=function(e,t){if(t.jqXHR&&"FileTooLong"===t.jqXHR.responseText)$("#jUploadStatus").html(msgFileTooLong).addClass("resultErr"),J();else{var a=120,i=1e3,l=function(){$.ajax({url:"imgLoad.ajax.aspx",data:{action:"sizeQuery",uploadId:t.formData.uploadId,fileIdx:t.formData.fileIdx},dataType:"text",success:function(e){t.uploadedBytes=Number(e),t.data=null,t.submit()},error:function(e){403===e.status?m():o(e,t)}})},n=t.retries||0;if(n<a)return t.retries=n+=1,void window.setTimeout(l,i);v("BetJs: Unspecified error during upload - 701")}},s=function(e,t){0<t.files.length&&(1<t.files.length?v("BetJs: Wrong implementation - 702"):($(".jBtnUpload").attr("value",labelUpload).removeAttr("disabled").removeClass("disabled"),$("#jUploadStatus").html("&nbsp;").removeClass("resultErr"),r(t),i=t,0<maxFileLength&&t.files[0].size>1024*maxFileLength&&(v(msgFileTooLong),$(".jBtnUpload").attr("disabled","disabled").addClass("disabled"))))},r=function(e){++l;var t,a=e.files[0];"image/jpeg"===a.type?t=window.loadImage(a,function(e){d(a,t,e)},{maxWidth:imgPrevMaxW,maxHeight:imgPrevMaxH}):(u(),i=void 0,$(".jBtnUpload").attr("disabled","disabled").addClass("disabled"))},d=function(e,t,a){var i;l!==n&&(n=l,$("#imgPreview").html(a),i=BetJs.Jelly.UploadUtils.FileSizeAsText(e.size),a=t.naturalWidth,t=t.naturalHeight,i="<strong>"+e.name+"</strong><span>"+a+" x "+t+" px</span><span>"+i+"</span>",$("#lbInfo").html(i))},u=function(){$.ajax({url:"loadUtils.ajax.aspx",data:{action:"imgBadContent"},dataType:"text",success:function(e){$("#imgPreview").html(e)}}),$("#lbInfo").html("&nbsp;")};a.UploadStart=function(){if(!i)return 0<imgId?void h():(parent&&parent.BetJs.Jelly.Admin.SetImg(fieldName,0,imgIdx),void a.Close());x(),$.ajax({url:"imgLoad.ajax.aspx",data:{action:"startUpload",typePath:typePath,fieldName:fieldName,varType:varType},dataType:"text",success:function(e){t=e,f()},error:function(e){403===e.status?m():v("BetJs: Unspecified error on upload start - 703")}})},a.RemoveImg=function(){confirm(msgDeleteConfirm)&&($.ajax({url:"loadUtils.ajax.aspx",data:{action:"noImgContent"},dataType:"text",success:function(e){$("#imgPreview").html(e)}}),imgId=0,i=void 0,$(".jBtnUpload").attr("value",labelSave))},a.Close=function(){parent&&parent.BetJs.Jelly.Admin.DialogClose(window.name)};var m=function(){BetJs.Jelly.UploadUtils.DenyDialog()},f=function(){var e;i&&(e=(e=i.files[0].fileName)||i.files[0].name,i.formData={fileIdx:0,uploadId:t,fileName:e},i.submit())},p=function(e,t){var a=Math.round(t.loaded/t.total*100),a=msgTrasferingData+" "+BetJs.Jelly.UploadUtils.FileSizeAsText(t.loaded)+" ("+a+" %)";$("#jUploadStatus").html(a).removeClass("resultErr")},c=function(e,t){Number(t.files[0].size)!==Number(t.result)?v("BetJs: Unspecified error during upload - 704"):g()},g=function(){var e="";document.forms[0].txAlt&&(e=document.forms[0].txAlt.value),$("#jUploadStatus").html(msgServerSaving).removeClass("resultErr"),$.ajax({url:"imgLoad.ajax.aspx",data:{action:"finishUpload",uploadId:t,alt:e},dataType:"text",success:function(e){parent&&(parent.BetJs.Jelly.Admin.SetImg(fieldName,e,imgIdx),a.Close())},error:function(e){if(403===e.status)m();else if(409===e.status){var t;try{t=JSON.parse(e.responseText)}catch(e){}v(t?t.errMsg:"BetJs: Unspecified error on upload finish - 705")}else v("BetJs: Unspecified error on upload finish - 706")}})},h=function(){$.ajax({url:"imgLoad.ajax.aspx",data:{action:"altEdit",typePath:typePath,fieldName:fieldName,imgId:imgId,alt:document.forms[0].txAlt.value},dataType:"text",success:function(){parent.BetJs.Jelly.Admin.Refresh(),a.Close()},error:function(e){403===e.status?m():v("BetJs: Unspecified error when saving data - 708")}})},v=function(e){$("#jUploadStatus").html(e).addClass("resultErr"),J()},x=function(){$(".jHidding").addClass("hidden"),$("#btSave").attr("disabled","disabled"),$(".jImgUploadForm").fileupload("option","add",e),$("#jButtons").hide()},J=function(){$(".jHidding").removeClass("hidden"),$("#btSave").removeAttr("disabled"),$(".jImgUploadForm").fileupload("option","add",s),$("#jButtons").show()};return a}(),$(document).ready(function(){BetJs.Jelly.ImgSimpleUpload.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.ImgSimpleUpload=function(){var i,t,a={},l=0,n=0;a.Ini=function(){var e=$(".jImgSimpleUploadForm");0!==e.length&&(e.fileupload({url:"imgSimpleLoad.ajax.aspx",maxChunkSize:9e5,add:s,fail:o,progressall:p,done:c}),$(".jBtnUpload").attr("value",0===imgId?labelUpload:labelSave))};function e(){}var o=function(e,t){if(t.jqXHR&&"FileTooLong"===t.jqXHR.responseText)$("#jUploadStatus").html(msgFileTooLong).addClass("resultErr"),B();else{var a=120,i=1e3,l=function(){$.ajax({url:"imgSimpleLoad.ajax.aspx",data:{action:"sizeQuery",uploadId:t.formData.uploadId,fileIdx:t.formData.fileIdx},dataType:"text",success:function(e){t.uploadedBytes=Number(e),t.data=null,t.submit()},error:function(e){403===e.status?m():o(e,t)}})},n=t.retries||0;if(n<a)return t.retries=n+=1,void window.setTimeout(l,i);x("BetJs: Unspecified error during upload - 701")}},s=function(e,t){0<t.files.length&&(1<t.files.length?x("BetJs: Wrong implementation - 702"):($(".jBtnUpload").attr("value",labelUpload).removeAttr("disabled").removeClass("disabled"),$("#jUploadStatus").html("&nbsp;").removeClass("resultErr"),r(t),i=t,0<maxFileLength&&t.files[0].size>1024*maxFileLength&&(x(msgFileTooLong),$(".jBtnUpload").attr("disabled","disabled").addClass("disabled"))))},r=function(e){++l;var t,a=e.files[0];"image/jpeg"===a.type||"image/png"===a.type||"image/gif"===a.type||"image/svg+xml"===a.type?t=window.loadImage(a,function(e){d(a,t,e)},{maxWidth:imgPrevMaxW,maxHeight:imgPrevMaxH}):(u(),i=void 0,$(".jBtnUpload").attr("disabled","disabled").addClass("disabled"))},d=function(e,t,a){var i;l!==n&&(n=l,$("#imgPreview").html(a),i=BetJs.Jelly.UploadUtils.FileSizeAsText(e.size),a=t.naturalWidth,t=t.naturalHeight,t="<strong>"+e.name+"</strong><span>"+a+" x "+t+" px</span><span>"+i+"</span>","image/svg+xml"===e.type&&(t="<strong>"+e.name+"</strong><span>"+i+"</span>"),$("#lbInfo").html(t))},u=function(){$.ajax({url:"loadUtils.ajax.aspx",data:{action:"simpleImgBadContent"},dataType:"text",success:function(e){$("#imgPreview").html(e)}}),$("#lbInfo").html("&nbsp;")};a.UploadStart=function(){if(!i)return 0<imgId?void h():(parent&&parent.BetJs.Jelly.Admin.SetImg(fieldName,0),void a.Close());J(),$.ajax({url:"imgSimpleLoad.ajax.aspx",data:{action:"startUpload",typePath:typePath,fieldName:fieldName,varType:varType},dataType:"text",success:function(e){t=e,f()},error:function(e){403===e.status?m():x("BetJs: Unspecified error on upload start - 703")}})},a.RemoveImg=function(){confirm(msgDeleteConfirm)&&($.ajax({url:"loadUtils.ajax.aspx",data:{action:"noImgContent"},dataType:"text",success:function(e){$("#imgPreview").html(e)}}),imgId=0,i=void 0,$(".jBtnUpload").attr("value",labelSave))},a.Close=function(){parent&&parent.BetJs.Jelly.Admin.DialogClose(window.name)};var m=function(){BetJs.Jelly.UploadUtils.DenyDialog()},f=function(){var e;i&&(e=(e=i.files[0].fileName)||i.files[0].name,i.formData={fileIdx:0,uploadId:t,fileName:e},i.submit())},p=function(e,t){var a=Math.round(t.loaded/t.total*100),a=msgTrasferingData+" "+BetJs.Jelly.UploadUtils.FileSizeAsText(t.loaded)+" ("+a+" %)";$("#jUploadStatus").html(a).removeClass("resultErr")},c=function(e,t){Number(t.files[0].size)!==Number(t.result)?x("BetJs: Unspecified error during upload - 704"):g()},g=function(){var e=v();$("#jUploadStatus").html(msgServerSaving).removeClass("resultErr"),$.ajax({url:"imgSimpleLoad.ajax.aspx",data:{action:"finishUpload",uploadId:t,ct:i.files[0].type,alt:e.alt,w:e.w,h:e.h,li:e.link},dataType:"text",success:function(e){parent&&(parent.BetJs.Jelly.Admin.SetImg(fieldName,e),a.Close())},error:function(e){if(403===e.status)m();else if(409===e.status){var t;try{t=JSON.parse(e.responseText)}catch(e){}x(t?t.errMsg:"BetJs: Unspecified error on upload finish - 705")}else x("BetJs: Unspecified error on upload finish - 706")}})},h=function(){var e=v();$.ajax({url:"imgSimpleLoad.ajax.aspx",data:{action:"altEdit",typePath:typePath,fieldName:fieldName,imgId:imgId,alt:e.alt,w:e.w,h:e.h,li:e.link},dataType:"text",success:function(){a.Close()},error:function(e){403===e.status?m():x("BetJs: Unspecified error when saving data - 708")}})},v=function(){var e=document.forms[0],t={};return t.alt=e.txAlt?e.txAlt.value:"",t.w=e.txWidth?e.txWidth.value:"",t.h=e.txHeight?e.txHeight.value:"",t.link=e.txLink?e.txLink.value:"",t},x=function(e){$("#jUploadStatus").html(e).addClass("resultErr"),B()},J=function(){$(".jHidding").addClass("hidden"),$("#btSave").attr("disabled","disabled"),$(".jImgSimpleUploadForm").fileupload("option","add",e),$("#jButtons").hide()},B=function(){$(".jHidding").removeClass("hidden"),$("#btSave").removeAttr("disabled"),$(".jImgSimpleUploadForm").fileupload("option","add",s),$("#jButtons").show()};return a}();