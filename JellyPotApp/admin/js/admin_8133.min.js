var bindCtrlSave,BetJs;BetJs.Browsers.DetectBlob()&&BetJs.Browsers.DetectXhr2()||(window.location.href="unsupported-browser.aspx"),$(document).ready(function(){BetJs.Jelly.Admin.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.Admin=function(){function n(e){for(var t=0;t<e.length;++t)if(e[t].selected)return e[t].value}var s={Ini:function(){},BtAction:function(e,t){var i;2===arguments.length&&!t||(i=document.forms[0]).hButtonAction&&(i.hButtonAction.value=e,i.submit())},Refresh:function(){document.forms[0].submit()},OpenVariable:function(e,t){e="main.aspx?v="+e+"&l="+lang;t&&(e+="&b="+t),document.location.href=e},AddVariable:function(e,t){e="main.aspx?a="+e+"&l="+lang;t&&(e+="&b="+t),document.location.href=e},ChooseVariable:function(e){e="main.aspx?m="+e+"&l="+lang;document.location.href=e},AddMixedVariable:function(e,t){document.location.href="main.aspx?m="+e+"&p="+t+"&l="+lang},OpenControl:function(e){document.location.href="main.aspx?c="+e+"&l="+lang},ConfirmDeleteVar:function(){return confirm(msgConfirmVarDelete)},OpenSpammer:function(e){document.location.href="main.aspx?s="+e+"&l="+lang},OpenSpammerAkce:function(e,t,i){t="main.aspx?s="+spamName+"&l="+lang+"&p1="+e+"&p2="+t;i&&(t+="&p3="+i),document.location.href=t},QuestionReset:function(){confirm(msgQuestionReset)&&(document.forms[0].hQAAkce.value=9,document.forms[0].submit())},SimpleImgEdit:function(e,t,i,n){s.DialogOpen("imgSimpleLoad.aspx?t="+e+"&f="+t+"&i="+i+"&v="+n,{width:902,height:452,closeText:"×"})},ImgEdit:function(e,t,i,n,l){s.DialogOpen("imgLoad.aspx?t="+e+"&f="+t+"&i="+i+"&x="+(l||0)+"&v="+n,{width:902,height:452,closeText:"×"})},ImgColBulkAdd:function(e,t,i){t="imgColLoad.aspx?t="+e+"&f="+t;s.DialogOpen(t=i?t+"&d="+i:t,{width:902,height:452,closeText:"×"})},SetImg:function(e,t,i){var n=document.forms[0];i?(n[e+"-Action"].value=2,n[e+"-Params"].value=t+"-"+i):(e=n[e])&&e.value&&(e.value=t),n.submit()},SetImgBulk:function(e,t){var i=document.forms[0];i[e+"-Action"].value=1,i[e+"-Params"].value=t,i.submit()},ImgDelete:function(e){confirm(msgImgDeleteConfirm)&&s.SetImg(e,0)},ImgColBulkDelete:function(e,t){var i,n,l,s=[];$(".imgColItem.ui-selecting").each(function(){(n=this.id.split("-"))[0]===t&&(s[s.length]=n[1])}),0!==s.length?confirm(msgImgDeleteBulkConfirm)&&(i=document.forms[0],n=i[t+"-Action"],l=i[t+"-Params"],n.value=9,l.value=s.join(","),i.submit()):alert(msgImgNoSelected)},FileEdit:function(e,t,i,n,l){s.DialogOpen("fileLoad.aspx?t="+e+"&f="+t+"&i="+i+"&x="+(l||0)+"&v="+n,{width:902,height:452,closeText:"×"})},SetFile:function(e,t,i){var n=document.forms[0];n[e+"-Action"]?(n[e+"-Action"].value=2,n[e+"-Params"].value=t+"-"+i):(e=n[e])&&e.value&&(e.value=t),n.submit()},FileDelete:function(e){confirm(msgFileDeleteConfirm)&&s.SetFile(e,0)},DownloadFile:function(e){window.location.href="fileGet.aspx?i="+e}};s.OnLangChange=function(){var e,t="",i=document.forms[0].selJazyky;i&&(t=n(i),0<(e=window.location.href).indexOf("l="+lang)?e=e.replace("l="+lang,"l="+t):(i="&",e+=(i=""===window.location.search?"?":i)+"l="+t),window.location.href=e)},s.OnCollectionFilter=function(){var e,t,i=document.forms[0].selCategory;i&&(t=n(i),t=(e=document.location.search).replace(/r=\d*/,i="r="+t),e===t&&(t=""===e?"?"+i:e+"&"+i),document.location.href=document.location.pathname+t)},s.FilterIni=function(t){BetJs.TableFilter.Ini({rowSelector:".f"+t,columns:[{colIndex:0,inputID:"txFilter-"+t,getTextMethod:function(e,t){return l(e,t)}}],noItemMethod:function(e){i(t,e)}})};var t,i=function(e,t){$("#txFilter-"+e).toggleClass("err",!t),$("#divFilterErr-"+e).toggle(!t)},l=function(e,t){for(var i="",n=e.children("td"),l=0;l<n.length-1;++l)i=i+" "+$(n[l]).text();return i};s.DialogOpen=function(e,t){var i="d"+Math.floor(1e5*Math.random());$('<div class="jDialog"><iframe src="'+e+'" name="'+i+'" /></div>').dialog(t)},s.DialogClose=function(e){e=$('iframe[name="'+e+'"]',parent.document).closest(".jDialog");e.dialog("isOpen")&&e.dialog("close")},s.OpenAdmin=function(e){var t="&";-1===e.indexOf("?")&&(t="?"),window.location.href=e+t+"l="+lang},s.WOpenWindow=function(e,t){void 0===t&&(t=""),window.open(e,t,"").focus()};function o(e){return e.id?e.id.split("-")[0]:""}return s.DragStart=function(e){t=o(e)},s.IsDrag=function(){return!!t},s.IsDragOver=function(e){return o(e)===t},s.DragEnd=function(){t=void 0},s.GetDragName=o,s}(),$(document).ready(function(){BetJs.Jelly.Resize.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.Resize=function(){var s,o,e={Ini:function(){n(),r(),u(),t(!0),$(window).on("resize",function(){t(!1)})}},i=0,t=function(e){var t,i,n=$("#sizeBarA"),l=$("#sizeBarB");e&&0<n.length&&0<l.length?(t=n.position().left,i=l.position().left,a(t,i)):(t=s,i=o);l=$(window).width()-108-t-8;l<400||(!e||l<i)&&(i=Math.min(i,l),$("#nav").css("width",t+0+"px"),$("#sizeBarA").css("left",t+0+"px"),$("#content").css("left",t+8+"px").css("width",i+2+"px"),$("#sizeBarB").css("left",i+0+"px"),u())},a=function(e,t){s=e,o=t},n=function(){$("#sizeBarA").draggable({axis:"x",start:function(){$("#sizeBarA").css("opacity",1),$("table.mceLayout iframe").css("visibility","hidden");var e=$("#sizeBarA").position().left,t=$("#sizeBarB").position().left;i=e+t},drag:function(e,t){l(e,t)},stop:function(e,t){l(e,t),$("#sizeBarA").css("opacity",""),$("table.mceLayout iframe").css("visibility","visible");var i=$("#sizeBarA").position().left,e=$("#sizeBarB").position().left;a(i,e),$.ajax({url:"main.ajax.aspx",data:{akce:"barAposition",v:t.position.left}})}})},l=function(e,t){Math.abs(t.position.left-220)<10&&(t.position.left=220),t.position.left<150&&(t.position.left=150),t.position.left>i-400&&(t.position.left=i-400);t=$("#sizeBarA").position().left;$("#nav").css("width",t+0+"px"),$("#content").css("left",t+8+"px").css("width",i-t+2+"px"),$("#sizeBarB").css("left",i-t+"px"),u()},r=function(){$("#sizeBarB").draggable({axis:"x",start:function(){$("#sizeBarB").css("opacity",1),$(".mce-tinymce iframe").css("visibility","hidden");var e=$("#sizeBarA").position().left,t=$("#sizeBarB").position().left;i=e+t},drag:function(e,t){c(e,t)},stop:function(e,t){c(e,t),$("#sizeBarB").css("opacity",""),$(".mce-tinymce iframe").css("visibility","visible");var i=$("#sizeBarA").position().left,e=$("#sizeBarB").position().left;a(i,e),$.ajax({url:"main.ajax.aspx",data:{akce:"barBposition",v:i+t.position.left}})}})},c=function(e,t){var i=$("#sizeBarA").position().left,n=920-i,i=$(window).width()-108-i-8;Math.abs(t.position.left-n)<10&&(t.position.left=n),t.position.left<400&&(t.position.left=400),t.position.left>i&&(t.position.left=i);i=$("#sizeBarB").position().left;$("#content").css("width",i+2+"px"),u()},u=function(){$(".refCollection").each(function(){var e=$(this),t=e.find(".controls").outerWidth(!0),t=Math.floor((e.outerWidth()-t)/2)-1;e.find(".listA, .listB").outerWidth(t)}),BetJs.UI.Select.ReIni()};return e}(),$(document).ready(function(){BetJs.Jelly.Texts.Ini(adminLang)}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.Texts=function(){var n={Ini:function(e){var t,i="cs"===e?l:s;for(t in i)n[t]=i[t]}},l={treeNoSelection:"Žádný řádek není označen.",treeNoLeft:"Řádek nelze posunout doleva.",treeNoRight:"Řádek nelze posunout doprava.",btRowEdit:"edit",imgBtEdit:"edit",imgColBtEdit:"edit",fileBtRowEdit:"edit"},s={treeNoSelection:"No row is selected.",treeNoLeft:"The row can not be moved left.",treeNoRight:"The row can not be moved right.",btRowEdit:"edit",imgBtEdit:"edit",imgColBtEdit:"edit",fileBtRowEdit:"edit"};return n}(),$(document).ready(function(){BetJs.Jelly.UI.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.UI=function(){var e={Ini:function(){t(),a(),o(),n(bindCtrlSave),s(),l()}},t=function(){$("#nav li.expanded ul").css({display:"block"}),$("#nav li h2").click(i),0<$("#navLangs").length&&$("#nav").addClass("has-languages")},i=function(){$(this).parent().find("ul").first().animate({height:"toggle"},200),$(this).parent().toggleClass("expanded");for(var e,t,i,n=[],l=$("#navVars li"),s=0;s<l.length;++s)t=l[s],$(t).hasClass("expanded")&&(i=BetJs.Tables.GetRowID(t),n.push(i.number),e=i.name);(e=!e&&0<l.length?(i=BetJs.Tables.GetRowID(l[0])).name:e)&&$.ajax({url:"main.ajax.aspx",data:{akce:"expanded",n:e,v:n.join(BetJs.Tables.btabSep)}})},n=function(e){$(document).on("keydown",function(e){var t=!1;return(e.ctrlKey||e.metaKey)&&83===e.keyCode&&(e.preventDefault(),t=!0),!t}),e&&$(document).on("keyup",function(e){var t=!1;return(e.ctrlKey||e.metaKey)&&83===e.keyCode&&(e.preventDefault(),t=!0,BetJs.Jelly.Admin.BtAction(22)),!t})},l=function(){var e,t;document.forms[0]&&document.forms[0].hsScrlV&&(e=Number(document.forms[0].hsScrlV.value),t=$(window),0===e||isNaN(e)||t.scrollTop(e),$(window).on("scroll",function(){document.forms[0].hsScrlV.value=Math.floor($(window).scrollTop()+.5)}))},s=function(){var e;0<$(".error:not(.message):visible").length&&(e=$('input[name="hsScrlV"]').val()||0,$('input[name="hsScrlV"]').val(""),$("html, body").scrollTop(e),$("html, body").animate({scrollTop:$(".error:not(.message):visible").eq(0).offset().top-$("header").outerHeight()},500))},o=function(){window.setTimeout(function(){$("#messageBox").removeClass("in")},2500)},a=function(){$("textarea.jTxAreaResizable").each(function(){this.lastHeight=$(this).outerHeight()}),$("textarea.jTxAreaResizable").mouseup(r)},r=function(){var e,t=$(this);this.lastHeight!==t.outerHeight()&&(e=t.outerHeight(),t=t.attr("name"),t=varTypeName+"."+t,$.ajax({url:"main.ajax.aspx",data:{akce:"taHeight",t:t,v:e}}))};return e}(),$(document).ready(function(){BetJs.Tables.selectedClass="selected",BetJs.Jelly.TreeCol.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.TreeCol=function(){function e(e){var t=$(e).closest("tr"),e=t.attr("data-v");void 0!==(t=t.attr("data-t"))&&""!=t?BetJs.Jelly.Admin.AddMixedVariable(e,t):BetJs.Jelly.Admin.OpenVariable(e)}function a(e){for(var t=BetJs.Tables.SelectionArray(e),i=new Array(0),n=0;n<t.length;++n)i[n]=Number(t[n]);return i.sort(l),i}var r,t={},l=function(e,t){return e-t};t.Ini=function(){i(),s(),n()};var i=function(){$(".var.jVarCol td:last-child").prepend('<span class="rowButton btMini jBtVarEdit">'+BetJs.Jelly.Texts.btRowEdit+"</span>"),$(".jTreeCol .t").parent().each(function(){$(".t",$(this)).height($(this).outerHeight())})},n=function(){var t=document.forms[0];$(".jTreeCol tr:first-child").each(function(){var e=BetJs.Jelly.Admin.GetDragName(this);BetJs.Tables.SetSelected(e,t[e+"-selected"].value)})},s=function(){$(".jTreeCol tr:not(.jEmptyItem)").draggable({addClasses:!1,appendTo:$(".jTreeCol").first(),helper:o,cursorAt:{left:-5},delay:100,revert:u,revertDuration:300,start:function(){BetJs.Jelly.Admin.DragStart(this),r=this},stop:d}),$(".jTreeCol tr:not(.jEmptyItem)").on("click.BetJs.Jelly.TreeCol",function(e){return BetJs.Tables.Select(this,e),c(this),!1}),$(".jVarCol tr:not(.jEmptyItem)").on("mouseover.BetJs.Jelly.TreeCol",function(){BetJs.Jelly.Admin.IsDragOver(this)?(r=this,$(this).addClass("dragOver")):BetJs.Jelly.Admin.IsDrag()||$(this).addClass("hover")}).on("mouseout.BetJs.Jelly.TreeCol",function(){r&&r===this&&(r=void 0),$(this).removeClass("dragOver").removeClass("hover")}).on("dblclick.BetJs.Jelly.TreeCol",function(){e(this)}),$(".jTreeCol tr.jEmptyItem").on("mouseover.BetJs.Jelly.TreeCol",function(){BetJs.Jelly.Admin.IsDragOver(this)&&(r=this,$(this).addClass("dragOver"))}).on("mouseout.BetJs.Jelly.TreeCol",function(){r&&r===this&&(r=void 0),$(this).removeClass("dragOver")}),$(".jVarCol .rowButton.jBtVarEdit").on("click.BetJs.Jelly.TreeCol",function(){e(this)})},o=function(e){var t=BetJs.Jelly.Admin.GetDragName(this);BetJs.Tables.SelectWithStartDrag(this,e),c(this);for(var e=$(this).closest("table").width(),i=$('<table class="dragHelper" style="width: '+e+'px" />'),n=a(t),l=0;l<n.length;++l){var s=$("#"+t+"-"+n[l]),o=s.clone();o.width(s.width()),i.append(o)}return i[0]},c=function(e){e=BetJs.Tables.GetRowID(e);document.forms[0][e.name+"-selected"].value=BetJs.Tables.GetSelected(e.name)},u=function(){var e=!1;return r||(e=!0,BetJs.Jelly.Admin.DragEnd(),r=void 0),e},d=function(){var e=BetJs.Tables.GetRowID(r);if(r=void 0,BetJs.Jelly.Admin.DragEnd(),$(".jTreeCol tr").removeClass("dragOver"),e&&e.name){var t=a(e.name),i=BetJs.Tables.NameArray(e.name),n=BetJs.Tables.LevelArray(e.name),l=e.number;l>i.length?l=i.length-1:l-=1;var s=n[t[0]],o=-1;if(0<(s=-1===l?0:l===i.length-1?Math.max(n[l],Math.min(n[l]+1,s)):Math.max(n[l+1],Math.min(n[l]+1,s))))for(o=l;n[o]>=s;)o=n.GetParent(o);f(e.name,o,l,t)}},f=function(e,t,i,n){for(var l=BetJs.Tables.NameArray(e),s=new Array(n.length),o=0;o<n.length;++o)s[o]=l[n[o]];document.forms[0][e+"-akce"].value=1,document.forms[0][e+"-selected"].value=s.join(BetJs.Tables.btabSep);var a=-1;-1<t&&(a=l[t]),document.forms[0][e+"-parent"].value=a,document.forms[0][e+"-target"].value=i,document.forms[0].submit()};return t.MoveLeft=function(e){var t=a(e);if(0!==t.length){for(var i,n=BetJs.Tables.LevelArray(e),l=n[t[0]],s=!0,o=t[0]+1;o<n.length&&!(n[o]<l);++o)if(n[o]===l&&-1===BetJs.Utils.ArrIndexOf(t,o)){s=!1;break}0!==l&&s?(i=n.GetParent(t[0]),i=n.GetParent(i),f(e,i,t[0],t)):alert(BetJs.Jelly.Texts.treeNoLeft)}else alert(BetJs.Jelly.Texts.treeNoSelection)},t.MoveRight=function(e){var t=a(e);if(0!==t.length){var i=BetJs.Tables.LevelArray(e);if(0===t[0]||i[t[0]-1]<i[t[0]])alert(BetJs.Jelly.Texts.treeNoRight);else{for(var n=t[0]-1;i[n]>i[t[0]];)--n;f(e,n,t[0]-1,t)}}else alert(BetJs.Jelly.Texts.treeNoSelection)},t}(),$(document).ready(function(){BetJs.Tables.selectedClass="selected",BetJs.Jelly.FileCol.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.FileCol=function(){function e(e,t){t=t||"tr";var i=$(e).closest(t),n=Number(i.attr("data-fileId")),e=Number(i.attr("data-idx")),t=(t=i.attr("data-typePath"))||"",i=i.attr("data-fieldName");BetJs.Jelly.Admin.FileEdit(t,i,n,e)}var l,t={},a=function(e,t){return e-t};t.Ini=function(){i(),s(),n()};var i=function(){$(".jFileCol td:last-child").prepend('<span class="rowButton btMini jBtFileEdit">'+BetJs.Jelly.Texts.fileBtRowEdit+"</span>")},n=function(){var t=document.forms[0];$(".jFileCol tr:first-child").each(function(){var e=BetJs.Jelly.Admin.GetDragName(this);BetJs.Tables.SetSelected(e,t[e+"-selected"].value)})},s=function(){$(".jFileCol tr:not(.jEmptyItem)").draggable({addClasses:!1,appendTo:$(".jFileCol").first(),helper:o,cursorAt:{left:-5},delay:100,revert:c,revertDuration:300,start:function(){BetJs.Jelly.Admin.DragStart(this),l=this},stop:u}),$(".jFileCol tr:not(.jEmptyItem)").on("click.BetJs.Jelly.FileCol",function(e){return BetJs.Tables.Select(this,e),r(this),!1}),$(".jFileCol tr:not(.jEmptyItem)").on("mouseover.BetJs.Jelly.FileCol",function(){BetJs.Jelly.Admin.IsDragOver(this)?(l=this,$(this).addClass("dragOver")):BetJs.Jelly.Admin.IsDrag()||$(this).addClass("hover")}).on("mouseout.BetJs.Jelly.FileCol",function(){l&&l===this&&(l=void 0),$(this).removeClass("dragOver").removeClass("hover")}).on("dblclick.BetJs.Jelly.FileCol",function(){e(this)}),$(".jFileCol tr.jEmptyItem").on("mouseover.BetJs.Jelly.FileCol",function(){BetJs.Jelly.Admin.IsDragOver(this)&&(l=this,$(this).addClass("dragOver"))}).on("mouseout.BetJs.Jelly.FileCol",function(){l&&l===this&&(l=void 0),$(this).removeClass("dragOver")}),$(".jFileCol .rowButton.jBtFileEdit").on("click.BetJs.Jelly.FileCol",function(){e(this)}),$(".jFileCol .jFileAdd").on("click.BetJs.Jelly.FileCol",function(){e(this,"span")})},o=function(e){var t=BetJs.Jelly.Admin.GetDragName(this);BetJs.Tables.SelectWithStartDrag(this,e),r(this);for(var e=$(this).closest("table").width(),i=$('<table class="dragHelper" style="width: '+e+'px" />'),n=function(e){for(var t=BetJs.Tables.SelectionArray(e),i=new Array(0),n=0;n<t.length;++n)i[n]=Number(t[n]);return i.sort(a),i}(t),l=0;l<n.length;++l){var s=$("#"+t+"-"+n[l]),o=s.clone();o.width(s.width()),i.append(o)}return i[0]},r=function(e){e=BetJs.Tables.GetRowID(e);document.forms[0][e.name+"-selected"].value=BetJs.Tables.GetSelected(e.name)},c=function(){var e=!1;return l||(e=!0,BetJs.Jelly.Admin.DragEnd(),l=void 0),e},u=function(){var e,t,i,n=BetJs.Tables.GetRowID(l);l=void 0,BetJs.Jelly.Admin.DragEnd(),$(".jFileCol tr").removeClass("dragOver"),n&&n.name&&(e=BetJs.Tables.NameArray(n.name),(t=n.number)>e.length?t=e.length-1:t-=1,(i=document.forms[0])[n.name+"-Action"].value=3,i[n.name+"-Params"].value=-1===t?t:e[t],i[n.name+"-selected"].value=BetJs.Tables.GetSelected(n.name),i.submit())};return t}(),$(document).ready(function(){BetJs.Jelly.ImgCol.Ini(),BetJs.Jelly.Img.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.ImgCol=function(){var e={Ini:function(){t(),i(),$(".imgColContainer.sortable").imgColSortable()}},t=function(){var e=BetJs.Jelly.Texts.imgColBtEdit;$(".imgColItem .outer").append('<span class="edit jBtImgColEdit">'+e+"</span>")},i=function(){$(".jBtImgColEdit").on("click.imgCol",function(){n(this)}),$(".imgColItem").on("dblclick.imgCol",function(){n(this)})},n=function(e){var t,i,n=$(e).closest("div.imgColItem");n.attr("data-v")?(t=n.attr("data-v"),BetJs.Jelly.Admin.OpenVariable(t)):n.attr("data-colimg")&&(i=n.attr("data-colimg").split(","),e=$.trim(i[0]),t=$.trim(i[1]),n=Number($.trim(i[2])),i=Number($.trim(i[3])),BetJs.Jelly.Admin.ImgEdit(e,t,i,n))};return e}(),BetJs.Jelly.Img=function(){var e={Ini:function(){t(),i()}},t=function(){var e=BetJs.Jelly.Texts.imgBtEdit;$(".singleImgItem .outer").append('<span class="edit jBtImgEdit">'+e+"</span>")},i=function(){$(".jBtImgEdit").on("click.imgCol",function(){n(this)}),$(".singleImgItem").on("dblclick.imgCol",function(){n(this)})},n=function(e){var t,i,n,l,s,e=$(e).closest("div.singleImgItem");e.attr("data-img")?(t=e.attr("data-img").split(","),i=$.trim(t[0]),n=$.trim(t[1]),l=Number($.trim(t[2])),s=$.trim(t[3]),BetJs.Jelly.Admin.ImgEdit(i,n,l,s)):e.attr("data-simg")&&(t=e.attr("data-simg").split(","),i=$.trim(t[0]),n=$.trim(t[1]),l=Number($.trim(t[2])),s=$.trim(t[3]),BetJs.Jelly.Admin.SimpleImgEdit(i,n,l,s))};return e}(),function(a){a.fn.multiSortable=function(e){a(this).data("sortData",e),this.children().off("mousedown.multiSortable").on("mousedown.multiSortable",function(e){e.ctrlKey||e.metaKey?a(e.currentTarget).toggleClass("ui-selecting"):a(e.currentTarget).hasClass("ui-selecting")||(a(".ui-selecting").removeClass("ui-selecting"),a(this).addClass("ui-selecting"))}),this.sortable({helper:"clone",update:function(e,t){var i=t.item,n=0;t.item.parent().children().each(function(){this.id!==t.item.get(0).id?a(this).hasClass("ui-selecting")&&(n?(i.after(this),i=a(this)):i.before(this)):n=1});var l,s,o=a(this).data("sortData");o&&o.onsort&&(l=[],a(this).children().each(function(){s=this.id.split("-"),l[l.length]=s[1]}),o.onsort(e,s[0],l))}})},a.fn.multiSortableDisable=function(){this.children().off("mousedown.multiSortable"),this.sortable("destroy")}}(jQuery),function(t){t.fn.imgColSortable=function(){var e="true"===t(this).children().attr("data-autosubmit");this.multiSortable({autosubmit:e,onsort:function(e,t,i){document.forms[0][t+"-Action"].value=3,document.forms[0][t+"-Params"].value=i.join(","),this.autosubmit&&document.forms[0].submit()}})}}(jQuery),$(document).ready(function(){BetJs.Tables.selectedClass="selected",BetJs.Jelly.RefCol.Ini()}),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.RefCol=function(){var l,s,n,o,a,e={},r=1;e.Ini=function(){m(),h(),I(),R()};function u(e){return e.id.substring(0,5)}function c(e){return e.id.substring(0,5)+"A"}function d(e){return e="string"==typeof e?e:e.id.substring(0,5),window[e+"WithOrder"]}function f(e){if(!window[e+"Idxs"]){for(var t=document.forms[0]["h"+e+"Ids"].value,i=""===t?[]:t.split(","),n=[],l=BetJs.Tables.NameArray(e+"B"),s=0;s<i.length;++s)n.push(l.GetIdxByName(i[s]));window[e+"Idxs"]=n}return window[e+"Idxs"]}var m=function(){$(document).on("mousemove.BetJs.Jelly.RefCol",function(){(l||s)&&BetJs.Browsers.ClearSelection()}),$(".jDragPickerA tr:not(.jEmptyItem)").draggable({helper:t,cursorAt:{left:-5},delay:200,revert:function(){return!o},revertDuration:300,start:function(){l=u(this),n=d(o=this)},stop:B}),$(".jDragPickerA").on("click.BetJs.Jelly.RefCol",function(){BetJs.Tables.UnselectAll(c(this))}).on("mouseover.BetJs.Jelly.RefCol",function(){s===u(this)&&$(this).addClass("dragOver")}).on("mousemove.BetJs.Jelly.RefCol",w).on("mouseout.BetJs.Jelly.RefCol",function(){o=void 0,$(this).removeClass("dragOver")}),$(".jDragPickerA tr:not(.jEmptyItem)").on("click.BetJs.Jelly.RefCol",function(e){return BetJs.Tables.Select(this,e,{OnShiftSelect:v}),BetJs.Tables.UnselectAll(u(this)),!1}).on("mouseover.BetJs.Jelly.RefCol",function(){var e=u(this);!n||l!==e&&s!==e?l||s||$(this).addClass("hover"):(o=this,$(this).addClass("dragOver"))}).on("mouseout.BetJs.Jelly.RefCol",function(){o&&o===this&&(o=void 0),$(this).removeClass("dragOver").removeClass("hover")}).on("dblclick.BetJs.Jelly.RefCol",function(){y(this)}),$(".jDragPickerA tr.jEmptyItem").on("mouseover.BetJs.Jelly.RefCol",function(){var e=u(this);!n||l!==e&&s!==e||(o=this,$(this).addClass("dragOver"))}).on("mouseout.BetJs.Jelly.RefCol",function(){o&&o===this&&(o=void 0),$(this).removeClass("dragOver")})},h=function(){$(".jDragPickerB tr.active").draggable({helper:i,cursorAt:{left:-5},delay:200,revert:function(){return!o},revertDuration:300,start:function(){s=u(this),o=void 0,n=d(this)},stop:B}),$(".jDragPickerB tr:not(.active)").draggable({helper:function(){return $("<p />")[0]}}),$(".jDragPickerB").on("mousemove.BetJs.Jelly.RefCol",function(){l===u(this)&&($(this).addClass("dragOver"),o=this)}).on("mouseout.BetJs.Jelly.RefCol",function(){o=void 0,$(this).removeClass("dragOver")}),$(".jDragPickerB tr.active").on("click.BetJs.Jelly.RefCol",function(e){return BetJs.Tables.Select(this,e,{OnShiftSelect:J}),BetJs.Tables.UnselectAll(c(this)),!1}).on("mouseover.BetJs.Jelly.RefCol",function(){s||l||$(this).addClass("hover")}).on("mouseout.BetJs.Jelly.RefCol",function(){$(this).removeClass("hover")}).on("dblclick.BetJs.Jelly.RefCol",function(){g(this)})},t=function(e){var t=u(this);BetJs.Tables.SelectWithStartDrag(this,e),BetJs.Tables.UnselectAll(this.id.substring(0,5)+"B");for(var i,n,e=$(this).closest("table").width(),l=$('<table class="treeColDragHelper" style="width: '+e+'px" />'),s=f(t),o=BetJs.Tables.SelectionArray(t+"A"),a=0;a<s.length;++a)BetJs.Utils.ArrContains(o,s[a])&&((n=(i=$("#"+t+"A-"+s[a])).clone()).width(i.width()),l.append(n));return l[0]},i=function(e){var t=u(this);BetJs.Tables.SelectWithStartDrag(this,e),BetJs.Tables.UnselectAll(c(this));for(var i,n,e=$(this).closest("table").width(),l=$('<table class="dragHelper" style="width: '+e+'px" />'),s=BetJs.Tables.NameArray(t+"B"),o=BetJs.Tables.SelectionArray(t+"B"),a=0;a<s.length;++a)BetJs.Utils.ArrContains(o,a)&&((n=(i=$("#"+t+"B-"+a)).clone()).width(i.width()),l.append(n));return l[0]},v=function(e,t,i){i=i.substring(0,5);for(var n=f(i),l=[],s=0,o=0;o<n.length;++o)if(0!==s||n[o]!==e&&n[o]!==t){if(1===s&&n[o]!==e&&l.push(n[o]),1===s&&(n[o]===e||n[o]===t))break}else n[o]!==e&&l.push(n[o]),s=1;return l},J=function(e,t,i){i=i.substring(0,5);var n=f(i),l=[],s=t<e?-1:1;for(e+=s;e!==t;e+=s)!BetJs.Utils.ArrContains(n,e)&&$("#"+i+"B-"+e).is(":visible")&&l.push(e);return!BetJs.Utils.ArrContains(n,t)&&$("#"+i+"B-"+t).is(":visible")&&l.push(t),l},B=function(){var e,t=o,i=s?2:l?1:0;s=l=o=void 0,$(".jDragPickerA tr").removeClass("dragOver"),$(".jDragPickerB").removeClass("dragOver"),$(".jDragPickerA").removeClass("dragOver"),T(),t&&0<i&&(e=u(t),1===i&&t===$("#"+e+"B")[0]?y(t):1===i?b(t):2===i&&(n?g:p)(t))},g=function(e){var t,i=u(e),n=f(i),l=BetJs.Tables.SelectionArray(i+"B");l.sort(function(e,t){return e-t});for(var s=BetJs.Tables.GetRowID(e).number,o=9999,a=0;a<n.length;++a)n[a]===s&&(o=a);var r=[];for(a=0;a<n.length&&a<o;)r.push(n[a]),++a;for(t=0;t<l.length;++t)r.push(l[t]);for(;a<n.length;)r.push(n[a]),++a;C(i,r,l,1),A(i,r)},p=function(e){var t=u(e),i=f(t),n=BetJs.Tables.SelectionArray(t+"B"),e=[];e.push.apply(e,i),e.push.apply(e,n),e.sort(function(e,t){return e-t}),C(t,e,n,1),A(t,e)},y=function(e){for(var e=u(e),t=f(e),i=BetJs.Tables.SelectionArray(e+"A"),n=[],l=0;l<t.length;++l)BetJs.Utils.ArrContains(i,t[l])||n.push(t[l]);C(e,n,i,2),A(e,n)},b=function(e){for(var t,i=u(e),n=f(i),l=BetJs.Tables.SelectionArray(i+"A"),s=BetJs.Tables.GetRowID(e).number,o=9999,a=[],r=0;r<n.length;++r)a.push(BetJs.Utils.ArrContains(l,n[r])?1:0),n[r]===s&&(o=r);var c=[];for(r=0;r<n.length&&r<o;)0===a[r]&&c.push(n[r]),++r;for(t=0;t<n.length;++t)1===a[t]&&c.push(n[t]);for(;r<n.length;)0===a[r]&&c.push(n[r]),++r;C(i,c,l,1),A(i,c),A(i,c)},C=function(e,t,i,n){var l=$("#"+e+"A table"),s=$("#"+e+"A .jEmptyItem").clone();for(l.empty().prepend(s),$("#"+e+"B tr").addClass("active").removeClass("selected").removeClass("hover"),r=t.length-1;0<=r;--r){var o=$("#"+e+"B-"+t[r]).removeClass("active").clone().attr("id",e+"A-"+t[r]).show();l.prepend(o)}$("#"+e+"A").toggleClass("empty",0===t.length);for(var a=i.slice(),r=0;r<a.length;++r)1===n&&$("#"+e+"A-"+a[r]).addClass("selected"),2===n&&$("#"+e+"B-"+a[r]).addClass("selected");s=BetJs.Tables.SelectionArray(e+"A"),i=BetJs.Tables.SelectionArray(e+"B");s.length=0,i.length=0,1===n&&s.push.apply(s,a),2===n&&i.push.apply(i,a),$(".jDragPickerA").off(".BetJs.Jelly.RefCol"),$(".jDragPickerA tr").off(".BetJs.Jelly.RefCol"),$(".jDragPickerB").off(".BetJs.Jelly.RefCol"),$(".jDragPickerB tr").off(".BetJs.Jelly.RefCol"),m(),h()},A=function(e,t){var i=f(e);i.length=0,i.push.apply(i,t);for(var n=[],l=BetJs.Tables.NameArray(e+"B"),s=0;s<i.length;++s)n.push(l[i[s]]);document.forms[0]["h"+e+"Ids"].value=n.join(",")};e.AddItems=function(e,t){var i=f(t).slice();if(e.ctrlKey||e.metaKey)for(var n=[],l=BetJs.Tables.NameArray(t+"B"),s=0;s<l.length;++s)BetJs.Utils.ArrContains(i,s)||(i.push(s),n.push(s));else n=BetJs.Tables.SelectionArray(t+"B"),i.push.apply(i,n),d(t)||i.sort(function(e,t){return e-t});C(t,i,n,1),A(t,i)},e.RemoveItems=function(e,t){var i=f(t).slice(),n=[];if(e.ctrlKey||e.metaKey)(l=[]).push.apply(l,i);else for(var l=BetJs.Tables.SelectionArray(t+"A"),s=0;s<i.length;++s)BetJs.Utils.ArrContains(l,i[s])||n.push(i[s]);C(t,n,l,2),A(t,n)},e.SwitchItems=function(e,t){for(var i=f(t).slice(),n=[],l=BetJs.Tables.NameArray(t+"B"),s=0;s<l.length;++s)BetJs.Utils.ArrContains(i,s)||n.push(s);C(t,n,[],0),A(t,n)};var w=function(e){var t=u(this),i=$(this),n=i.offset().top,i=i.outerHeight(),e=e.pageY;(l===t||s===t)&&n<=e&&e<=n+20?(r=Math.min(Math.max(6*(20-(e-n))/20,1),5),a=a||window.setInterval(function(){var e=$("#"+t+"A");e.scrollTop(e.scrollTop()-r)},20)):(l===t||s===t)&&n+i-20<=e&&e<=n+i?(r=Math.min(Math.max(6*(20-(n+i-e))/20,1),5),a=a||window.setInterval(function(){var e=$("#"+t+"A");e.scrollTop(e.scrollTop()+r)},20)):T(),s!==t||o||(o=this)},T=function(){a&&(window.clearInterval(a),a=void 0)},I=function(){$(".jPickerFilter").on("keydown.BetJs.Jelly.RefCol",x).on("keyup.BetJs.Jelly.RefCol",D).attr("autocomplete","off")},x=function(e){13===e.keyCode&&e.preventDefault(),38===e.keyCode&&(S(this,"up"),e.preventDefault()),40===e.keyCode&&(S(this,"down"),e.preventDefault())},D=function(e){var t=this.value.toLowerCase();38!==e.keyCode&&40!==e.keyCode&&13!==e.keyCode&&k(this,t),13===e.keyCode&&j(this)},k=function(e,i){var e=u(e),n=!1,l=f(e),s=BetJs.Tables.SelectionArray(e+"B");s.length=0,$("#"+e+"B tr").each(function(){var e,t=$(this);t.removeClass("selected"),""===i?t.show():-1<t.find("td").text().toLowerCase().indexOf(i)?(t.show(),n||(e=BetJs.Tables.GetRowID(this).number,BetJs.Utils.ArrContains(l,e)||(n=!0,t.addClass("selected"),s[0]=e))):t.hide()})},j=function(e){var t=u(e);0!==BetJs.Tables.SelectionArray(t+"B").length&&(BetJs.Jelly.RefCol.AddItems({},t),e.value="",e.oldValue="",$("#"+t+"B tr").each(function(){$(this).show()}))},S=function(e,t){var i,n=u(e),l=BetJs.Tables.SelectionArray(n+"B");l.length=0;e=$("#"+n+"B tr.oznac");"up"===t?i=e.prevAll("tr.active:visible:first"):"down"===t&&(i=e.nextAll("tr.active:visible:first")),0===i.length&&("up"===t?i=$("#"+n+"B tr.active:visible:last"):"down"===t&&(i=$("#"+n+"B tr.active:visible:first"))),0<i.length&&(n=BetJs.Tables.GetRowID(i[0]).number,e.removeClass("selected"),i.addClass("selected"),l[0]=n)},R=function(){$(".jDragPickerB").each(function(){this.lastHeight=$(this).outerHeight()}),$(".jDragPickerB").mouseup(O)},O=function(){var e,t=$(this);this.lastHeight!==t.outerHeight()&&(e=t.outerHeight(),t=t.attr("data-fieldName"),$.ajax({url:"main.ajax.aspx",data:{akce:"taHeight",t:t,v:e}}))};return e}(),(BetJs=BetJs||{}).Jelly||(BetJs.Jelly={}),BetJs.Jelly.Tiny=function(){var a,r,c,u={GetConfig:function(){return{entity_encoding:"raw",valid_elements:"@[id|class],strong/b,em/i,#p,-ol,-ul,-li,br,-sub,-sup,-h2,-h3,div,blockquote,span,code",extended_valid_elements:"img[*],iframe[*],a[href|target]",convert_urls:!1,min_height:30,plugins:"charmap visualchars nonbreaking link code",menubar:!1,toolbar1:"styleselect | bullist numlist | bold italic subscript superscript | link | charmap visualchars nonbreaking | code",toolbar2:"",toolbar_items_size:"small",style_formats:[{title:"nadpis 2",block:"h2"},{title:"nadpis 3",block:"h3"},{title:"odstavec",block:"p"}],browser_spellcheck:!0}}};u.Ini=function(e,t,i,n){var l,s=u.GetConfig();if("cs"===n&&(l={}),l="en"===n?{style_formats:[{title:"Header 2",block:"h2"},{title:"Header 3",block:"h3"},{title:"Paragraph",block:"p"}]}:l)try{$.extend(s,l)}catch(e){}if(i)try{var o=BetJs.Browsers.RunFunction(i);$.extend(s,o)}catch(e){}s.selector="textarea#"+e,t&&(s.content_css=t),n&&(s.language=n),s.setup=function(t){t.on("ResizeEditor",function(){var e=$("#"+t.id).prev("div.mce-tinymce").find("iframe").height();a&&window.clearTimeout(a),r=t.id,c=e,a=window.setTimeout(d,100)}),t.on("keydown",function(e){var t=!1;return(e.ctrlKey||e.metaKey)&&83===e.keyCode&&(e.preventDefault(),t=!0),!t}),t.on("keyup",function(e){var t=!1;return(e.ctrlKey||e.metaKey)&&83===e.keyCode&&(e.preventDefault(),t=!0,BetJs.Jelly.Admin.BtAction(22)),!t})},tinyMCE.init(s)};var d=function(){var e=varTypeName+"."+r;$.ajax({url:"main.ajax.aspx",data:{akce:"taHeight",t:e,v:c}}),a=void 0,$("iframe").width("100%"),$(".mce-tinymce").width("auto")};return u}();